# Assignment 13: Cis Regulatory Evolution
## Introduction
--- 
As we learned in class this week, one way to find putative regulatory regions in intergenic DNA
is to look for conserved sites among related species. However, to identify conserved sites, you
first need to know how often neutral sites are conserved so that you can tell how many
conserved bases you would expect by chance (null model). In this week’s assignment you will
generate an alignment of orthologous genes from four related yeast species. Using this
alignment, you will then calculate the neutral rate from wobble positions in the open reading
frames. Finally, you will use the neutral rate you determined to identify regions of noncoding
DNA that are conserved more than expected. 
--- 
### Part 1 
The FASTA file containing genomic DNA sequences for the promoter and open reading frame of
the PRE1 gene from *S. cerevisiae, S. paradoxus, S. bayanus,* and *S. kudriavzevii* is located
in the class folder. In the FASTA, the promoter sequence
is lowercased, and the open reading frame is uppercased. Copy `PRE1.fa` to your work
directory. (Yes, you may copy this file to your work directory.) Use the command-line tool
`clustalw` to perform a multiple sequence alignment with the provided FASTA file. Additional information on the 'clustalw` line can be found by using the help command
`clustalw -help`

You need to use two options to run clustalw: one that lets you specify the input sequences and
one that tells the program to perform full multiple alignment. (See DATA and VERBS sections of
help menu.) After running clustalw, some output will be displayed on the screen and two output
files will be created. You are interested in the output given in the alignment file output with
suffix `.aln.`

--- 
### Part 2
Write a Python script `neutral_rate.py` which calculates the fraction of wobble positions that
are conserved across all 4 species starting from a conserved start codon until the end of the
sequence (which is a stop codon in all 4 species). Consider only third position wobbles. 

The usage of your script should be:
`python3 neutral_rate.py **clustawlw alignment file**`.

Feel free to use named arguments such as `--alignment-file.`

**Question 1:** What is the fraction of wobble positions that are conserved?

---
### Part 3
Using the neutral rate of conservation you calculated in part 2 and the binomial equation
discussed in class, calculate a cutoff for calling a 10 bp sequence significantly more conserved
than expected under the neutral hypothesis at a p-value ≤ 0.05. You do not need to write a
program to do this—Python modules can be used to calculate values of a binomial distribution
within a script or within interactive mode.

**Question 2:** How many base pairs must be conserved for a 10 bp sequence to be significantly more
conserved than expected? How did you arrive at this answer? Be explicit and give usage
statements if you used Python.

---
### Part 4
Modify `neutral_rate.py` to use an overlapping windows approach to identify promoter
sequence regions ≥ 10 bp within which each 10 bp sub-sequence is more conserved than
expected. Create an output file in which you print the start and stop position of each conserved
window along with the relevant S. cerevisiae (Scer) sequence. Include an informative header
line. Call the file `S_cer_conserved.txt.`

The usage of your script should now be: 
<span style="color:blue;">python3 neutral_rate.py</span> <span style="color:red;">clustalw alignment file, min bp conserved,
window length </span>

The `S_cer_conserved.txt` file should be tab-delimited and have an informative header with
the following columns:

| Column | Description              | Example          |
|--------|--------------------------|------------------|
| 0      | Start position (0-based) | 100              |
| 1      | Stop Position (0-based)  | 115              |
| 2      | Scer Sequence            | ACTGACTGACTGACTG |

**Question 3**: How many regions did you find?


--- 
### Part 5
The JASPAR database is an open access database for annotating transcription factor binding
profiles. Please use the “Scan” function (on the far right, halfway down) within the JASPAR
database of yeast motifs with a “Relative profile score threshold” of 90% to determine if the S.
cerevisiae regions you’ve identified contain any binding sites. Be sure to toggle all JASPAR
matrix models on and format your sequences as FASTA in the SCAN box. Test just one
sequence at a time.

**Question 4:** How does the number of binding sites in conserved regions compare to the number in the entire
promoter region? What are your thoughts on the results of this comparison?

**Question 5:** Do any of the conserved binding sites fit with the annotation that PRE1 is involved in yeast
proteasome assembly? Explain how you arrived at your answer.

---
## What to turn in
- A commented 'neutral_rate.py`
- Your clustalw output file `PRE1.aln`
- Your neutral_rate.py output file `S_cer_conserved.txt`
- Your `README.txt` with the answers to all questions and the commands you used to answer the questions
